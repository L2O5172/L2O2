<!DOCTYPE html>
<html lang="zh-TW">
<head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no" />
    <title>美味廚房店家管理系統</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Noto+Sans+TC:wght@400;500;700&display=swap" rel="stylesheet">
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <style>
        body {
            font-family: 'Noto Sans TC', sans-serif;
            -webkit-tap-highlight-color: transparent;
        }
        @media print {
            body * { visibility: hidden; }
            .print-area, .print-area * { visibility: visible; }
            .print-area { position: absolute !important; left: 0 !important; top: 0 !important; width: 100% !important; }
            .print-area * { color: #000 !important; background-color: transparent !important; box-shadow: none !important; border-color: #ddd !important; }
            .no-print { display: none !important; }
        }
    </style>
    <script type="importmap">
    {
      "imports": {
        "react-dom/": "https://aistudiocdn.com/react-dom@^19.2.0/",
        "react/": "https://aistudiocdn.com/react@^19.2.0/",
        "react": "https://aistudiocdn.com/react@^19.2.0"
      }
    }
    </script>
    <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
</head>
<body class="bg-slate-100 min-h-screen">
    <div id="root"></div>
    <script type="text/babel" data-type="module">
        import React from 'react';
        import ReactDOM from 'react-dom/client';

        const API_URL = 'https://script.google.com/macros/s/AKfycbx83vpj3iuB6rPorzWodu9pVw3UyMSzsfUBwQZe9a90ZSvWdZvr16D_uhIbjV3mpvvJ/exec';

        const apiService = {
            async fetchOrders(filters = {}) {
                const params = new URLSearchParams({ action: 'getOrders', ...filters });
                const res = await fetch(`${API_URL}?${params}`);
                const data = await res.json();
                return data.success ? data.orders : [];
            },
            async updateOrderStatus(orderId, newStatus) {
                const payload = { action: 'updateOrderStatus', orderId, status: newStatus };
                const res = await fetch(API_URL, {
                    method: 'POST',
                    headers: { 'Content-Type': 'application/json' },
                    body: JSON.stringify(payload)
                });
                return await res.json();
            },
            async getMenuAndAddons() {
                const res = await fetch(`${API_URL}?action=getMenu`);
                const data = await res.json();
                return data.success ? { menu: data.menu, addons: data.addons } : { menu: [], addons: [] };
            },
            async updateMenuItem(item) {
                const payload = { action: 'updateMenuItem', ...item };
                const res = await fetch(API_URL, {
                    method: 'POST',
                    headers: { 'Content-Type': 'application/json' },
                    body: JSON.stringify(payload)
                });
                return await res.json();
            },
            async updateAddon(addon) {
                const payload = { action: 'updateAddon', ...addon };
                const res = await fetch(API_URL, {
                    method: 'POST',
                    headers: { 'Content-Type': 'application/json' },
                    body: JSON.stringify(payload)
                });
                return await res.json();
            },
            async setupSheet() {
                const res = await fetch(API_URL, {
                    method: 'POST',
                    headers: { 'Content-Type': 'application/json' },
                    body: JSON.stringify({ action: 'setupSheet' })
                });
                return await res.json();
            }
        };

        const STATUS_COLORS = {
            '確認中': 'bg-blue-500 text-white',
            '準備中': 'bg-yellow-500 text-white',
            '可以取餐': 'bg-purple-500 text-white',
            '完成': 'bg-green-600 text-white'
        };

        const OrderRow = ({ order, onStatusChange }) => {
            const [status, setStatus] = React.useState(order.status);
            const [isUpdating, setIsUpdating] = React.useState(false);

            const handleStatusChange = async (newStatus) => {
                setIsUpdating(true);
                const res = await apiService.updateOrderStatus(order.id, newStatus);
                if (res.success) setStatus(newStatus);
                setIsUpdating(false);
            };

            const aggregated = React.useMemo(() => {
                const drinks = {}, sauces = {}, addons = {};
                order.items.forEach(it => {
                    if (it.selectedDrinks) Object.entries(it.selectedDrinks).forEach(([n,q]) => drinks[n] = (drinks[n]||0)+q);
                    if (it.selectedSauces) it.selectedSauces.forEach(s => sauces[s.name] = (sauces[s.name]||0)+s.quantity);
                    if (it.selectedAddons) it.selectedAddons.forEach(a => addons[a.name] = {quantity:(addons[a.name]?.quantity||0)+a.quantity, price:a.price});
                });
                return {drinks, sauces, addons};
            }, [order.items]);

            return (
                <div className="bg-white rounded-lg shadow p-4 mb-4">
                    <div className="flex justify-between items-start mb-2">
                        <div>
                            <p className="font-mono font-bold text-lg">{order.id}</p>
                            <p className="text-sm text-slate-600">{new Date(order.timestamp).toLocaleString('zh-TW')}</p>
                        </div>
                        <div className="flex items-center gap-2">
                            <select
                                value={status}
                                onChange={e => handleStatusChange(e.target.value)}
                                disabled={isUpdating}
                                className={`px-3 py-1 rounded-full text-sm font-bold ${STATUS_COLORS[status]} disabled:opacity-70`}
                            >
                                {Object.keys(STATUS_COLORS).map(s => <option key={s} value={s}>{s}</option>)}
                            </select>
                        </div>
                    </div>
                    <div className="grid grid-cols-1 md:grid-cols-2 gap-4 text-sm">
                        <div>
                            <p><span className="font-semibold">顧客：</span>{order.customerName} ({order.customerPhone})</p>
                            <p><span className="font-semibold">類型：</span>{order.orderType}{order.tableNumber ? ` / 桌號 ${order.tableNumber}` : ''}</p>
                            <p className="font-bold text-green-700 mt-1">總金額：${order.totalAmount}</p>
                        </div>
                        <div>
                            <p className="font-semibold mb-1">餐點：</p>
                            <ul className="list-disc list-inside text-xs space-y-1">
                                {order.items.map((it, i) => (
                                    <li key={i}>
                                        {it.item.name} x{it.quantity}
                                        {it.selectedDonenesses && Object.keys(it.selectedDonenesses).length > 0 && ` (${Object.entries(it.selectedDonenesses).map(([d,q])=>`${d}x${q}`).join(', ')})`}
                                        {it.selectedNotes && ` - ${it.selectedNotes}`}
                                    </li>
                                ))}
                            </ul>
                            {Object.keys(aggregated.drinks).length > 0 && <p className="text-xs mt-1"><span className="font-semibold">飲料：</span>{Object.entries(aggregated.drinks).map(([n,q])=>`${n} x${q}`).join(', ')}</p>}
                            {Object.keys(aggregated.sauces).length > 0 && <p className="text-xs"><span className="font-semibold">沾醬：</span>{Object.entries(aggregated.sauces).map(([n,q])=>`${n} x${q}`).join(', ')}</p>}
                            {Object.keys(aggregated.addons).length > 0 && (
                                <div className="text-xs"><span className="font-semibold">加購：</span>
                                    <ul className="list-disc list-inside pl-3">
                                        {Object.entries(aggregated.addons).map(([n,{quantity,price}])=> <li key={n}>{n} x{quantity} (+${price*quantity})</li>)}
                                    </ul>
                                </div>
                            )}
                        </div>
                    </div>
                </div>
            );
        };

        const MenuManager = () => {
            const [menu, setMenu] = React.useState([]);
            const [addons, setAddons] = React.useState([]);
            const [loading, setLoading] = React.useState(true);

            const loadData = async () => {
                setLoading(true);
                const { menu, addons } = await apiService.getMenuAndAddons();
                setMenu(menu);
                setAddons(addons);
                setLoading(false);
            };

            React.useEffect(() => { loadData(); }, []);

            const toggleAvailability = async (type, id) => {
                if (type === 'menu') {
                    const item = menu.flatMap(c=>c.items).find(i=>i.id===id);
                    const res = await apiService.updateMenuItem({ ...item, isAvailable: !item.isAvailable });
                    if (res.success) loadData();
                } else {
                    const addon = addons.find(a=>a.id===id);
                    const res = await apiService.updateAddon({ ...addon, isAvailable: !addon.isAvailable });
                    if (res.success) loadData();
                }
            };

            if (loading) return <div className="text-center py-8">載入中...</div>;

            return (
                <div className="space-y-8">
                    <div className="flex justify-between items-center">
                        <h2 className="text-2xl font-bold">菜單管理</h2>
                        <button onClick={loadData} className="bg-green-600 text-white px-4 py-2 rounded hover:bg-green-700">重新載入</button>
                    </div>
                    {menu.map(cat => (
                        <div key={cat.title} className="bg-white rounded-lg shadow p-4">
                            <h3 className="font-bold text-lg mb-2">{cat.title}</h3>
                            <div className="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-3">
                                {cat.items.map(item => (
                                    <div key={item.id} className={`p-3 border rounded ${item.isAvailable ? 'border-green-300 bg-green-50' : 'border-red-300 bg-red-50'}`}>
                                        <p className="font-medium">{item.name} ({item.weight}) - ${item.price}</p>
                                        <button onClick={() => toggleAvailability('menu', item.id)} className={`mt-2 px-3 py-1 rounded text-sm ${item.isAvailable ? 'bg-red-500 text-white' : 'bg-green-500 text-white'}`}>
                                            {item.isAvailable ? '設為售完' : '恢復供應'}
                                        </button>
                                    </div>
                                ))}
                            </div>
                        </div>
                    ))}
                    <div className="bg-white rounded-lg shadow p-4">
                        <h3 className="font-bold text-lg mb-2">加購項目</h3>
                        <div className="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-3">
                            {addons.map(addon => (
                                <div key={addon.id} className={`p-3 border rounded ${addon.isAvailable ? 'border-green-300 bg-green-50' : 'border-red-300 bg-red-50'}`}>
                                    <p className="font-medium">{addon.name} - +${addon.price}</p>
                                    <button onClick={() => toggleAvailability('addon', addon.id)} className={`mt-2 px-3 py-1 rounded text-sm ${addon.isAvailable ? 'bg-red-500 text-white' : 'bg-green-500 text-white'}`}>
                                        {addon.isAvailable ? '設為售完' : '恢復供應'}
                                    </button>
                                </div>
                            ))}
                        </div>
                    </div>
                </div>
            );
        };

        const Reports = () => {
            const [dateRange, setDateRange] = React.useState({ start: '', end: '' });
            const [reportData, setReportData] = React.useState(null);
            const [loading, setLoading] = React.useState(false);
            const [chart1, setChart1] = React.useState(null);
            const [chart2, setChart2] = React.useState(null);
            const [chart3, setChart3] = React.useState(null);

            const fetchReport = async () => {
                if (!dateRange.start || !dateRange.end) return;
                setLoading(true);
                const orders = await apiService.fetchOrders({ startDate: dateRange.start, endDate: dateRange.end });
                
                const stats = {
                    totalOrders: orders.length,
                    totalRevenue: orders.reduce((s,o) => s + o.totalAmount, 0),
                    avgOrderValue: orders.length > 0 ? Math.round(orders.reduce((s,o) => s + o.totalAmount, 0) / orders.length) : 0,
                    dineInCount: orders.filter(o => o.orderType === '內用').length,
                    takeoutCount: orders.filter(o => o.orderType === '外帶').length,
                };

                const dailyData = {};
                const itemSales = {};
                const addonSales = {};
                const drinkSales = {};
                const sauceSales = {};

                orders.forEach(order => {
                    const date = order.timestamp.split('T')[0];
                    dailyData[date] = (dailyData[date] || { count: 0, revenue: 0 });
                    dailyData[date].count += 1;
                    dailyData[date].revenue += order.totalAmount;

                    order.items.forEach(it => {
                        const name = it.item.name;
                        itemSales[name] = (itemSales[name] || { qty: 0, revenue: 0 });
                        itemSales[name].qty += it.quantity;
                        itemSales[name].revenue += it.item.price * it.quantity;

                        if (it.selectedAddons) {
                            it.selectedAddons.forEach(a => {
                                addonSales[a.name] = (addonSales[a.name] || { qty: 0, revenue: 0 });
                                addonSales[a.name].qty += a.quantity;
                                addonSales[a.name].revenue += a.price * a.quantity;
                            });
                        }
                        if (it.selectedDrinks) {
                            Object.entries(it.selectedDrinks).forEach(([n,q]) => {
                                drinkSales[n] = (drinkSales[n] || { qty: 0, revenue: 0 });
                                drinkSales[n].qty += q;
                            });
                        }
                        if (it.selectedSauces) {
                            it.selectedSauces.forEach(s => {
                                sauceSales[s.name] = (sauceSales[s.name] || 0) + s.quantity;
                            });
                        }
                    });
                });

                setReportData({ stats, dailyData, itemSales, addonSales, drinkSales, sauceSales });
                setLoading(false);
            };

            React.useEffect(() => {
                if (reportData && !loading) {
                    // Daily Revenue Chart
                    const dates = Object.keys(reportData.dailyData).sort();
                    const dailyRevenue = dates.map(d => reportData.dailyData[d].revenue);
                    const dailyOrders = dates.map(d => reportData.dailyData[d].count);

                    if (chart1) chart1.destroy();
                    const ctx1 = document.getElementById('chart1').getContext('2d');
                    setChart1(new Chart(ctx1, {
                        type: 'line',
                        data: {
                            labels: dates,
                            datasets: [
                                { label: '營收', data: dailyRevenue, borderColor: '#10b981', tension: 0.1 },
                                { label: '訂單數', data: dailyOrders, borderColor: '#3b82f6', yAxisID: 'y1', tension: 0.1 }
                            ]
                        },
                        options: { responsive: true, scales: { y: { beginAtZero: true }, y1: { position: 'right', beginAtZero: true } } }
                    }));

                    // Top Items Chart
                    const topItems = Object.entries(reportData.itemSales)
                        .sort((a,b) => b[1].qty - a[1].qty)
                        .slice(0, 10);
                    if (chart2) chart2.destroy();
                    const ctx2 = document.getElementById('chart2').getContext('2d');
                    setChart2(new Chart(ctx2, {
                        type: 'bar',
                        data: {
                            labels: topItems.map(i => i[0]),
                            datasets: [{ label: '銷售數量', data: topItems.map(i => i[1].qty), backgroundColor: '#10b981' }]
                        },
                        options: { responsive: true, indexAxis: 'y' }
                    }));

                    // Addon & Drink Pie
                    const addonData = Object.entries(reportData.addonSales).map(([n,v]) => ({ name: n, qty: v.qty }));
                    const drinkData = Object.entries(reportData.drinkSales).map(([n,v]) => ({ name: n, qty: v.qty }));
                    const pieData = [...addonData, ...drinkData].sort((a,b) => b.qty - a.qty).slice(0, 8);
                    if (chart3) chart3.destroy();
                    const ctx3 = document.getElementById('chart3').getContext('2d');
                    setChart3(new Chart(ctx3, {
                        type: 'doughnut',
                        data: {
                            labels: pieData.map(i => i.name),
                            datasets: [{ data: pieData.map(i => i.qty), backgroundColor: ['#f59e0b','#ef4444','#3b82f6','#10b981','#8b5cf6','#ec4899','#6366f1','#14b8a6'] }]
                        },
                        options: { responsive: true }
                    }));
                }
            }, [reportData, loading]);

            return (
                <div className="space-y-6">
                    <div className="bg-white rounded-lg shadow p-6">
                        <h2 className="text-2xl font-bold mb-4">報表分析</h2>
                        <div className="flex flex-wrap gap-3 mb-4">
                            <input
                                type="date"
                                value={dateRange.start}
                                onChange={e => setDateRange(prev => ({ ...prev, start: e.target.value }))}
                                className="px-3 py-2 border rounded-lg"
                            />
                            <span className="self-center">至</span>
                            <input
                                type="date"
                                value={dateRange.end}
                                onChange={e => setDateRange(prev => ({ ...prev, end: e.target.value }))}
                                className="px-3 py-2 border rounded-lg"
                            />
                            <button
                                onClick={fetchReport}
                                disabled={loading || !dateRange.start || !dateRange.end}
                                className="bg-green-600 text-white px-6 py-2 rounded-lg hover:bg-green-700 disabled:opacity-50"
                            >
                                {loading ? '生成中...' : '生成報表'}
                            </button>
                        </div>
                    </div>

                    {reportData && (
                        <>
                            <div className="grid grid-cols-1 md:grid-cols-4 gap-4">
                                <div className="bg-white rounded-lg shadow p-4 text-center">
                                    <p className="text-3xl font-bold text-green-600">{reportData.stats.totalOrders}</p>
                                    <p className="text-sm text-slate-600">總訂單數</p>
                                </div>
                                <div className="bg-white rounded-lg shadow p-4 text-center">
                                    <p className="text-3xl font-bold text-blue-600">${reportData.stats.totalRevenue}</p>
                                    <p className="text-sm text-slate-600">總營收</p>
                                </div>
                                <div className="bg-white rounded-lg shadow p-4 text-center">
                                    <p className="text-3xl font-bold text-purple-600">${reportData.stats.avgOrderValue}</p>
                                    <p className="text-sm text-slate-600">平均客單價</p>
                                </div>
                                <div className="bg-white rounded-lg shadow p-4 text-center">
                                    <p className="text-2xl font-bold text-orange-600">{reportData.stats.dineInCount} / {reportData.stats.takeoutCount}</p>
                                    <p className="text-sm text-slate-600">內用 / 外帶</p>
                                </div>
                            </div>

                            <div className="grid grid-cols-1 lg:grid-cols-2 gap-6">
                                <div className="bg-white rounded-lg shadow p-4">
                                    <h3 className="text-lg font-bold mb-3">每日營收與訂單趨勢</h3>
                                    <canvas id="chart1" className="max-h-64"></canvas>
                                </div>
                                <div className="bg-white rounded-lg shadow p-4">
                                    <h3 className="text-lg font-bold mb-3">熱銷主餐 Top 10</h3>
                                    <canvas id="chart2" className="max-h-64"></canvas>
                                </div>
                            </div>

                            <div className="bg-white rounded-lg shadow p-4">
                                <h3 className="text-lg font-bold mb-3">熱門加購與飲料</h3>
                                <canvas id="chart3" className="max-h-96 mx-auto"></canvas>
                            </div>

                            <div className="grid grid-cols-1 md:grid-cols-2 gap-6">
                                <div className="bg-white rounded-lg shadow p-4">
                                    <h3 className="text-lg font-bold mb-3">主餐銷售排行</h3>
                                    <div className="space-y-2 text-sm">
                                        {Object.entries(reportData.itemSales)
                                            .sort((a,b) => b[1].revenue - a[1].revenue)
                                            .slice(0, 10)
                                            .map(([name, data]) => (
                                                <div key={name} className="flex justify-between">
                                                    <span>{name}</span>
                                                    <span className="font-mono">{data.qty}份 / ${data.revenue}</span>
                                                </div>
                                            ))}
                                    </div>
                                </div>
                                <div className="bg-white rounded-lg shadow p-4">
                                    <h3 className="text-lg font-bold mb-3">醬料偏好統計</h3>
                                    <div className="space-y-2 text-sm">
                                        {Object.entries(reportData.sauceSales)
                                            .sort((a,b) => b[1] - a[1])
                                            .map(([name, qty]) => (
                                                <div key={name} className="flex justify-between">
                                                    <span>{name}</span>
                                                    <span className="font-mono">{qty}次</span>
                                                </div>
                                            ))}
                                    </div>
                                </div>
                            </div>
                        </>
                    )}
                </div>
            );
        };

        const Dashboard = () => {
            const [orders, setOrders] = React.useState([]);
            const [filter, setFilter] = React.useState('all');
            const [dateFilter, setDateFilter] = React.useState('');
            const [loading, setLoading] = React.useState(true);

            const loadOrders = async () => {
                setLoading(true);
                const filters = {};
                if (filter !== 'all') filters.status = filter;
                if (dateFilter) filters.date = dateFilter;
                const data = await apiService.fetchOrders(filters);
                setOrders(data);
                setLoading(false);
            };

            React.useEffect(() => { loadOrders(); }, [filter, dateFilter]);

            const stats = React.useMemo(() => {
                const today = new Date().toISOString().split('T')[0];
                const todayOrders = orders.filter(o => o.timestamp.startsWith(today));
                return {
                    total: orders.length,
                    today: todayOrders.length,
                    revenue: todayOrders.reduce((s,o) => s + o.totalAmount, 0),
                    pending: orders.filter(o => o.status === '確認中').length
                };
            }, [orders]);

            return (
                <div className="space-y-6">
                    <div className="grid grid-cols-1 md:grid-cols-4 gap-4">
                        <div className="bg-white rounded-lg shadow p-4 text-center">
                            <p className="text-3xl font-bold text-green-600">{stats.total}</p>
                            <p className="text-sm text-slate-600">總訂單</p>
                        </div>
                        <div className="bg-white rounded-lg shadow p-4 text-center">
                            <p className="text-3xl font-bold text-blue-600">{stats.today}</p>
                            <p className="text-sm text-slate-600">今日訂單</p>
                        </div>
                        <div className="bg-white rounded-lg shadow p-4 text-center">
                            <p className="text-3xl font-bold text-purple-600">${stats.revenue}</p>
                            <p className="text-sm text-slate-600">今日營收</p>
                        </div>
                        <div className="bg-white rounded-lg shadow p-4 text-center">
                            <p className="text-3xl font-bold text-yellow-600">{stats.pending}</p>
                            <p className="text-sm text-slate-600">待處理</p>
                        </div>
                    </div>

                    <div className="bg-white rounded-lg shadow p-4">
                        <div className="flex flex-wrap gap-2 mb-4">
                            <button onClick={() => setFilter('all')} className={`px-4 py-2 rounded ${filter==='all'?'bg-green-600 text-white':'bg-slate-200'}`}>全部</button>
                            {Object.keys(STATUS_COLORS).map(s => (
                                <button key={s} onClick={() => setFilter(s)} className={`px-4 py-2 rounded ${filter===s?STATUS_COLORS[s]:'bg-slate-200'}`}>{s}</button>
                            ))}
                            <input type="date" value={dateFilter} onChange={e=>setDateFilter(e.target.value)} className="ml-auto px-3 py-2 border rounded" />
                        </div>
                        {loading ? <div className="text-center py-8">載入中...</div> :
                         orders.length === 0 ? <div className="text-center py-8 text-slate-500">無訂單資料</div> :
                         <div className="space-y-4 max-h-96 overflow-y-auto">
                             {orders.map(order => <OrderRow key={order.id} order={order} onStatusChange={loadOrders} />)}
                         </div>
                        }
                    </div>
                </div>
            );
        };

        const App = () => {
            const [activeTab, setActiveTab] = React.useState('dashboard');
            const [setupDone, setSetupDone] = React.useState(false);
            const [setupLoading, setSetupLoading] = React.useState(false);

            const handleSetup = async () => {
                setSetupLoading(true);
                const res = await apiService.setupSheet();
                setSetupDone(res.success);
                setSetupLoading(false);
            };

            return (
                <div className="min-h-screen bg-slate-100">
                    <header className="bg-white shadow-md sticky top-0 z-10">
                        <div className="container mx-auto px-4 py-4 flex justify-between items-center">
                            <h1 className="text-2xl font-bold text-green-800">美味廚房店家管理系統</h1>
                            <div className="flex gap-2">
                                <button onClick={() => setActiveTab('dashboard')} className={`px-4 py-2 rounded ${activeTab==='dashboard'?'bg-green-600 text-white':'bg-slate-200'}`}>訂單總覽</button>
                                <button onClick={() => setActiveTab('menu')} className={`px-4 py-2 rounded ${activeTab==='menu'?'bg-green-600 text-white':'bg-slate-200'}`}>菜單管理</button>
                                <button onClick={() => setActiveTab('reports')} className={`px-4 py-2 rounded ${activeTab==='reports'?'bg-green-600 text-white':'bg-slate-200'}`}>報表分析</button>
                            </div>
                        </div>
                    </header>

                    <main className="container mx-auto p-4 md:p-6">
                        {!setupDone ? (
                            <div className="bg-yellow-50 border border-yellow-300 rounded-lg p-6 text-center">
                                <p className="mb-4">首次使用需初始化 Google Sheet 資料表</p>
                                <button onClick={handleSetup} disabled={setupLoading} className="bg-green-600 text-white px-6 py-3 rounded-lg hover:bg-green-700 disabled:opacity-70">
                                    {setupLoading ? '初始化中...' : '一鍵設定工作表'}
                                </button>
                            </div>
                        ) : activeTab === 'dashboard' ? <Dashboard /> : activeTab === 'menu' ? <MenuManager /> : <Reports />}
                    </main>
                </div>
            );
        };

        const root = ReactDOM.createRoot(document.getElementById('root'));
        root.render(<App />);
    </script>
</body>
</html>
